<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pedtask API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pedtask</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python

from __future__ import absolute_import, print_function

import os
import time
import string
import pickle
import re
import platform
import subprocess

import gi;  gi.require_version(&#34;Gtk&#34;, &#34;3.0&#34;)
from gi.repository import Gtk
from gi.repository import Gdk
from gi.repository import GLib
from gi.repository import GObject
from gi.repository import Pango

gi.require_version(&#39;PangoCairo&#39;, &#39;1.0&#39;)
from gi.repository import PangoCairo

from pedlib import  pedconfig
from pedlib import  peddraw
from pedlib import  pedxtnd
from pedlib import  pedync
from pedlib import  pedspell
from pedlib import  pedcolor
from pedlib import  pedmenu
from pedlib import  pedundo
from pedlib import  pedmisc

from pedlib.pedutil import *
from pedlib.keywords import *

class pedtask():
    def __init__(self):
        print(&#34;Pedtask started&#34;, pedtask)

    # Pass in two lists, one for linux and one for windows
    def start_external(self, linprog, winprog):

        #print(&#34;start_external&#34;, linprog)

        try:
            if platform.system().find(&#34;Win&#34;) &gt;= 0:
                ret = subprocess.Popen(winprog)
                #if not ret.returncode:
                #    raise OSError
            else:
                ret = subprocess.Popen(linprog)
                #if not ret.returncode:
                #    raise OSError
        except:
            print(&#34;Cannot launch %s&#34; % str(linprog), sys.exc_info())
            pedync.message(&#34;\n   Cannot launch %s \n\n&#34;  % str(linprog) +
                                     str(sys.exc_info()))


    # --------------------------------------------------------------------
    # I could not get it to work stdin stdout hung
    # removed from menu

    def start_edit(self, filex):

        old = os.getcwd()
        fdir = os.path.dirname(os.path.realpath(__file__))
        #print(&#34;fdir:&#34;, fdir)
        mydir = os.path.dirname(os.path.join(fdir, &#34;../&#34;))
        print(&#34;mydir:&#34;, mydir)
        os.chdir(mydir)
        myscript = os.path.realpath(os.path.join(mydir, &#39;pyedpro.py&#39;))
        mysh = os.path.realpath(os.path.join(fdir, &#39;run.sh&#39;))

        if pedconfig.conf.verbose:
            print(&#34;myscript:&#34;, myscript, &#34;filex:&#34;, filex)

        ret = 0
        try:
            if platform.system().find(&#34;Win&#34;) &gt;= 0:
                print(&#34;No exec function on windows. (TODO)&#34;)
                pedync.message(&#34;\n   No exec function on windows. \n\n&#34;)
            else:
                pass
                # Stumble until editor found
                #ret = subprocess.call([&#34;xfce4-terminal&#34;, &#34;-x&#34;, mysh,  myscript, filex])
                #ret = subprocess.Popen(sss, shell=True)
                #

                #stdinx= os.dup2(0, os.fdopen(0, &#34;r&#34;).fileno())
                #stdoutx=os.dup2(1, os.fdopen(1, &#34;w&#34;).fileno())
                #stderrx=os.dup2(2, os.fdopen(2, &#34;w&#34;).fileno())
                #
                ret = subprocess.Popen([&#34;python3&#34;,  myscript, filex, &#34;&amp;&#34;],
                            close_fds=True, start_new_session=True,
                            stdout=subprocess.PIPE,
                                    stderr=subprocess.STDOUT)

                # Restore crap
                #sys.stdin= os.fdopen(0, &#34;r&#34;).fileno()
                #sys.stdout=os.fdopen(1, &#34;w&#34;).fileno()
                #sys.stderr=os.fdopen(2, &#34;w&#34;).fileno()

                if ret.returncode:
                    ret = subprocess.Popen([&#34;python&#34;, myscript, filex])
                    if not ret.returncode:
                        raise OSError

                #try:
                #    pid = os.fork()
                #except (OSError, e):
                #    print(&#34;cannot fork&#34;)
                #    #sys.exit(1)
                #if pid == 0:
                #    ## eventually use os.putenv(..) to set environment variables
                #    ## os.execv strips of args[0] for the arguments
                #    try:
                #        os.execv(&#34;/usr/bin/env&#34;, [&#34;python&#34;, myscript, filex, &#34; &amp;&#34;])
                #    except:
                #        print(&#34;Cannot exec &#34;, sys.exc_info())
                ##pid = os.spawnlp(os.P_NOWAIT, myscript, filex, &#34;&#34;)
                ##print(&#34;pid&#34;, pid)

        except:
            print(&#34;Cannot launch new editor instance&#34;, sys.exc_info())
            pedync.message(&#34;\n   Cannot launch new editor instance \n\n&#34;)

        # Back to original dir
        print(&#34;Back to original thread.&#34;, old)
        #print(&#34;env&#34;, os.environ)
        #os.chdir(os.path.dirname(old))

    # --------------------------------------------------------------------
    def start_mdfilter(self):

        #print(&#34;MD Filter called.&#34;, os.getcwd())

        yfname = os.path.dirname(__file__) + os.sep + &#34;default.yml&#34;

        print(yfname)

        #comline = [&#34;md2html&#34;, &#34;-s&#34;, yfname, self.fname,]

        comline = [&#34;markdown&#34;, self.fname,]

        outs = &#39;&#39;
        try:
            ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
        except:
            print(&#34;Cannot start MD filter %s&#34; % str(comline), sys.exc_info())
            pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                       str(sys.exc_info()) )
            return
        try:
            outs, errs = ret.communicate()
        except:
            print(&#34;Cannot communicate with MD filter %s&#34; % str(comline), sys.exc_info())
            return

        newfname = os.path.splitext(self.fname)[0] + &#34;.preview.html&#34;
        #print(&#34;processed:&#34;, self.fname, newfname)
        with open(newfname,&#39;wb&#39;) as fd:
            fd.write(outs)

        if not os.path.isfile(newfname):
            print(&#34;No conversion on %s&#34; % self.fname)
            pedync.message(&#34;\n   Cannot convert &#39;%s&#39; \n&#34;
                &#34;   to MD / HTML file\n\n&#34;  % self.fname )
            return

        self.start_htmlwin(newfname)
        pedconfig.conf.pedwin.cleanit.append(newfname)


    def start_browser(self, newfname):
        comline2 = [&#34;firefox&#34;, newfname,]
        try:
            ret = subprocess.Popen(comline2)
        except:
            print(&#34;Cannot start browser %s&#34; % str(comline2), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline2) +
                       str(sys.exc_info()) )
            return

    def start_htmlwin(self, newfname):
        try:
            xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;
            #print(&#34;xfname&#34;, )
            #comline3 = [&#34;python&#34;, xfname, &#34;-d&#34;, newfname,]
            comline3 = [&#34;firefox&#34;, newfname,]

            try:
                ret = subprocess.Popen(comline3)
            except:
                print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
                pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                           str(sys.exc_info()) )
                return
        except:
            print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                       str(sys.exc_info()) )
            return

    def start_htmlstr(self):
        try:
            xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;

            sumstr = &#34;&#34;
            for bb in self.text:
                sumstr += bb + &#34;\n&#34;

            comline3 = [&#34;python&#34;, xfname, sumstr, ]
            try:
                ret = subprocess.Popen(comline3)
            except:
                print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
                pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                           str(sys.exc_info()) )
                return
        except:
            print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                       str(sys.exc_info()) )
            return

    def start_m4filter(self):

        #print(&#34;Filter called.&#34;)
        self.save()
        comline = [&#34;m4&#34;, self.fname,]
        try:
            ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
        except:
            print(&#34;Cannot filter %s&#34; % str(comline), sys.exc_info())
            pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                       str(sys.exc_info()) )
            return
        try:
            outs, errs = ret.communicate()
        except:
            print(&#34;Cannot communicate with filter %s&#34; % str(comline), sys.exc_info())
            return

        res = outs.decode(&#34;cp437&#34;)
        #print(&#34;res&#34;, res)

        www = self.mained.get_width()
        if self.mained.hpaned3.get_position() &gt; www - 20:
            self.mained.hpaned3.set_position(www - www / 4)
            self.mained.update_statusbar(&#34;Filter output active&#34;)

        newfname = os.path.splitext(self.fname)[0] + &#34;.html&#34;

        pppp = self.notebook3.get_nth_page(0)
        self.notebook3.set_tab_label(pppp,
                    self.mained.make_label(&#34;Filter on M4 &#39;&#34; +
                             os.path.basename(newfname) + &#34;&#39;&#34;))
        arrx = res.split(&#34;\n&#34;)
        self.mained.diffpane.area.loadbuff(arrx)
        self.mained.diffpane.area.fname = newfname
        self.mained.update_statusbar(&#34;M4 filter output activated.&#34;)
        self.start_htmlwin(res)

# EOF</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pedtask.pedtask"><code class="flex name class">
<span>class <span class="ident">pedtask</span></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class pedtask():
    def __init__(self):
        print(&#34;Pedtask started&#34;, pedtask)

    # Pass in two lists, one for linux and one for windows
    def start_external(self, linprog, winprog):

        #print(&#34;start_external&#34;, linprog)

        try:
            if platform.system().find(&#34;Win&#34;) &gt;= 0:
                ret = subprocess.Popen(winprog)
                #if not ret.returncode:
                #    raise OSError
            else:
                ret = subprocess.Popen(linprog)
                #if not ret.returncode:
                #    raise OSError
        except:
            print(&#34;Cannot launch %s&#34; % str(linprog), sys.exc_info())
            pedync.message(&#34;\n   Cannot launch %s \n\n&#34;  % str(linprog) +
                                     str(sys.exc_info()))


    # --------------------------------------------------------------------
    # I could not get it to work stdin stdout hung
    # removed from menu

    def start_edit(self, filex):

        old = os.getcwd()
        fdir = os.path.dirname(os.path.realpath(__file__))
        #print(&#34;fdir:&#34;, fdir)
        mydir = os.path.dirname(os.path.join(fdir, &#34;../&#34;))
        print(&#34;mydir:&#34;, mydir)
        os.chdir(mydir)
        myscript = os.path.realpath(os.path.join(mydir, &#39;pyedpro.py&#39;))
        mysh = os.path.realpath(os.path.join(fdir, &#39;run.sh&#39;))

        if pedconfig.conf.verbose:
            print(&#34;myscript:&#34;, myscript, &#34;filex:&#34;, filex)

        ret = 0
        try:
            if platform.system().find(&#34;Win&#34;) &gt;= 0:
                print(&#34;No exec function on windows. (TODO)&#34;)
                pedync.message(&#34;\n   No exec function on windows. \n\n&#34;)
            else:
                pass
                # Stumble until editor found
                #ret = subprocess.call([&#34;xfce4-terminal&#34;, &#34;-x&#34;, mysh,  myscript, filex])
                #ret = subprocess.Popen(sss, shell=True)
                #

                #stdinx= os.dup2(0, os.fdopen(0, &#34;r&#34;).fileno())
                #stdoutx=os.dup2(1, os.fdopen(1, &#34;w&#34;).fileno())
                #stderrx=os.dup2(2, os.fdopen(2, &#34;w&#34;).fileno())
                #
                ret = subprocess.Popen([&#34;python3&#34;,  myscript, filex, &#34;&amp;&#34;],
                            close_fds=True, start_new_session=True,
                            stdout=subprocess.PIPE,
                                    stderr=subprocess.STDOUT)

                # Restore crap
                #sys.stdin= os.fdopen(0, &#34;r&#34;).fileno()
                #sys.stdout=os.fdopen(1, &#34;w&#34;).fileno()
                #sys.stderr=os.fdopen(2, &#34;w&#34;).fileno()

                if ret.returncode:
                    ret = subprocess.Popen([&#34;python&#34;, myscript, filex])
                    if not ret.returncode:
                        raise OSError

                #try:
                #    pid = os.fork()
                #except (OSError, e):
                #    print(&#34;cannot fork&#34;)
                #    #sys.exit(1)
                #if pid == 0:
                #    ## eventually use os.putenv(..) to set environment variables
                #    ## os.execv strips of args[0] for the arguments
                #    try:
                #        os.execv(&#34;/usr/bin/env&#34;, [&#34;python&#34;, myscript, filex, &#34; &amp;&#34;])
                #    except:
                #        print(&#34;Cannot exec &#34;, sys.exc_info())
                ##pid = os.spawnlp(os.P_NOWAIT, myscript, filex, &#34;&#34;)
                ##print(&#34;pid&#34;, pid)

        except:
            print(&#34;Cannot launch new editor instance&#34;, sys.exc_info())
            pedync.message(&#34;\n   Cannot launch new editor instance \n\n&#34;)

        # Back to original dir
        print(&#34;Back to original thread.&#34;, old)
        #print(&#34;env&#34;, os.environ)
        #os.chdir(os.path.dirname(old))

    # --------------------------------------------------------------------
    def start_mdfilter(self):

        #print(&#34;MD Filter called.&#34;, os.getcwd())

        yfname = os.path.dirname(__file__) + os.sep + &#34;default.yml&#34;

        print(yfname)

        #comline = [&#34;md2html&#34;, &#34;-s&#34;, yfname, self.fname,]

        comline = [&#34;markdown&#34;, self.fname,]

        outs = &#39;&#39;
        try:
            ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
        except:
            print(&#34;Cannot start MD filter %s&#34; % str(comline), sys.exc_info())
            pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                       str(sys.exc_info()) )
            return
        try:
            outs, errs = ret.communicate()
        except:
            print(&#34;Cannot communicate with MD filter %s&#34; % str(comline), sys.exc_info())
            return

        newfname = os.path.splitext(self.fname)[0] + &#34;.preview.html&#34;
        #print(&#34;processed:&#34;, self.fname, newfname)
        with open(newfname,&#39;wb&#39;) as fd:
            fd.write(outs)

        if not os.path.isfile(newfname):
            print(&#34;No conversion on %s&#34; % self.fname)
            pedync.message(&#34;\n   Cannot convert &#39;%s&#39; \n&#34;
                &#34;   to MD / HTML file\n\n&#34;  % self.fname )
            return

        self.start_htmlwin(newfname)
        pedconfig.conf.pedwin.cleanit.append(newfname)


    def start_browser(self, newfname):
        comline2 = [&#34;firefox&#34;, newfname,]
        try:
            ret = subprocess.Popen(comline2)
        except:
            print(&#34;Cannot start browser %s&#34; % str(comline2), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline2) +
                       str(sys.exc_info()) )
            return

    def start_htmlwin(self, newfname):
        try:
            xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;
            #print(&#34;xfname&#34;, )
            #comline3 = [&#34;python&#34;, xfname, &#34;-d&#34;, newfname,]
            comline3 = [&#34;firefox&#34;, newfname,]

            try:
                ret = subprocess.Popen(comline3)
            except:
                print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
                pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                           str(sys.exc_info()) )
                return
        except:
            print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                       str(sys.exc_info()) )
            return

    def start_htmlstr(self):
        try:
            xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;

            sumstr = &#34;&#34;
            for bb in self.text:
                sumstr += bb + &#34;\n&#34;

            comline3 = [&#34;python&#34;, xfname, sumstr, ]
            try:
                ret = subprocess.Popen(comline3)
            except:
                print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
                pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                           str(sys.exc_info()) )
                return
        except:
            print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                       str(sys.exc_info()) )
            return

    def start_m4filter(self):

        #print(&#34;Filter called.&#34;)
        self.save()
        comline = [&#34;m4&#34;, self.fname,]
        try:
            ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
        except:
            print(&#34;Cannot filter %s&#34; % str(comline), sys.exc_info())
            pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                       str(sys.exc_info()) )
            return
        try:
            outs, errs = ret.communicate()
        except:
            print(&#34;Cannot communicate with filter %s&#34; % str(comline), sys.exc_info())
            return

        res = outs.decode(&#34;cp437&#34;)
        #print(&#34;res&#34;, res)

        www = self.mained.get_width()
        if self.mained.hpaned3.get_position() &gt; www - 20:
            self.mained.hpaned3.set_position(www - www / 4)
            self.mained.update_statusbar(&#34;Filter output active&#34;)

        newfname = os.path.splitext(self.fname)[0] + &#34;.html&#34;

        pppp = self.notebook3.get_nth_page(0)
        self.notebook3.set_tab_label(pppp,
                    self.mained.make_label(&#34;Filter on M4 &#39;&#34; +
                             os.path.basename(newfname) + &#34;&#39;&#34;))
        arrx = res.split(&#34;\n&#34;)
        self.mained.diffpane.area.loadbuff(arrx)
        self.mained.diffpane.area.fname = newfname
        self.mained.update_statusbar(&#34;M4 filter output activated.&#34;)
        self.start_htmlwin(res)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="pedtask.pedtask.start_browser"><code class="name flex">
<span>def <span class="ident">start_browser</span></span>(<span>self, newfname)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_browser(self, newfname):
    comline2 = [&#34;firefox&#34;, newfname,]
    try:
        ret = subprocess.Popen(comline2)
    except:
        print(&#34;Cannot start browser %s&#34; % str(comline2), sys.exc_info())
        pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline2) +
                   str(sys.exc_info()) )
        return</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_edit"><code class="name flex">
<span>def <span class="ident">start_edit</span></span>(<span>self, filex)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_edit(self, filex):

    old = os.getcwd()
    fdir = os.path.dirname(os.path.realpath(__file__))
    #print(&#34;fdir:&#34;, fdir)
    mydir = os.path.dirname(os.path.join(fdir, &#34;../&#34;))
    print(&#34;mydir:&#34;, mydir)
    os.chdir(mydir)
    myscript = os.path.realpath(os.path.join(mydir, &#39;pyedpro.py&#39;))
    mysh = os.path.realpath(os.path.join(fdir, &#39;run.sh&#39;))

    if pedconfig.conf.verbose:
        print(&#34;myscript:&#34;, myscript, &#34;filex:&#34;, filex)

    ret = 0
    try:
        if platform.system().find(&#34;Win&#34;) &gt;= 0:
            print(&#34;No exec function on windows. (TODO)&#34;)
            pedync.message(&#34;\n   No exec function on windows. \n\n&#34;)
        else:
            pass
            # Stumble until editor found
            #ret = subprocess.call([&#34;xfce4-terminal&#34;, &#34;-x&#34;, mysh,  myscript, filex])
            #ret = subprocess.Popen(sss, shell=True)
            #

            #stdinx= os.dup2(0, os.fdopen(0, &#34;r&#34;).fileno())
            #stdoutx=os.dup2(1, os.fdopen(1, &#34;w&#34;).fileno())
            #stderrx=os.dup2(2, os.fdopen(2, &#34;w&#34;).fileno())
            #
            ret = subprocess.Popen([&#34;python3&#34;,  myscript, filex, &#34;&amp;&#34;],
                        close_fds=True, start_new_session=True,
                        stdout=subprocess.PIPE,
                                stderr=subprocess.STDOUT)

            # Restore crap
            #sys.stdin= os.fdopen(0, &#34;r&#34;).fileno()
            #sys.stdout=os.fdopen(1, &#34;w&#34;).fileno()
            #sys.stderr=os.fdopen(2, &#34;w&#34;).fileno()

            if ret.returncode:
                ret = subprocess.Popen([&#34;python&#34;, myscript, filex])
                if not ret.returncode:
                    raise OSError

            #try:
            #    pid = os.fork()
            #except (OSError, e):
            #    print(&#34;cannot fork&#34;)
            #    #sys.exit(1)
            #if pid == 0:
            #    ## eventually use os.putenv(..) to set environment variables
            #    ## os.execv strips of args[0] for the arguments
            #    try:
            #        os.execv(&#34;/usr/bin/env&#34;, [&#34;python&#34;, myscript, filex, &#34; &amp;&#34;])
            #    except:
            #        print(&#34;Cannot exec &#34;, sys.exc_info())
            ##pid = os.spawnlp(os.P_NOWAIT, myscript, filex, &#34;&#34;)
            ##print(&#34;pid&#34;, pid)

    except:
        print(&#34;Cannot launch new editor instance&#34;, sys.exc_info())
        pedync.message(&#34;\n   Cannot launch new editor instance \n\n&#34;)

    # Back to original dir
    print(&#34;Back to original thread.&#34;, old)
    #print(&#34;env&#34;, os.environ)
    #os.chdir(os.path.dirname(old))</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_external"><code class="name flex">
<span>def <span class="ident">start_external</span></span>(<span>self, linprog, winprog)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_external(self, linprog, winprog):

    #print(&#34;start_external&#34;, linprog)

    try:
        if platform.system().find(&#34;Win&#34;) &gt;= 0:
            ret = subprocess.Popen(winprog)
            #if not ret.returncode:
            #    raise OSError
        else:
            ret = subprocess.Popen(linprog)
            #if not ret.returncode:
            #    raise OSError
    except:
        print(&#34;Cannot launch %s&#34; % str(linprog), sys.exc_info())
        pedync.message(&#34;\n   Cannot launch %s \n\n&#34;  % str(linprog) +
                                 str(sys.exc_info()))</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_htmlstr"><code class="name flex">
<span>def <span class="ident">start_htmlstr</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_htmlstr(self):
    try:
        xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;

        sumstr = &#34;&#34;
        for bb in self.text:
            sumstr += bb + &#34;\n&#34;

        comline3 = [&#34;python&#34;, xfname, sumstr, ]
        try:
            ret = subprocess.Popen(comline3)
        except:
            print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                       str(sys.exc_info()) )
            return
    except:
        print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
        pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                   str(sys.exc_info()) )
        return</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_htmlwin"><code class="name flex">
<span>def <span class="ident">start_htmlwin</span></span>(<span>self, newfname)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_htmlwin(self, newfname):
    try:
        xfname = os.path.dirname(__file__) + os.sep + &#34;webwin.py&#34;
        #print(&#34;xfname&#34;, )
        #comline3 = [&#34;python&#34;, xfname, &#34;-d&#34;, newfname,]
        comline3 = [&#34;firefox&#34;, newfname,]

        try:
            ret = subprocess.Popen(comline3)
        except:
            print(&#34;Cannot start browser %s&#34; % str(comline3), sys.exc_info())
            pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(comline3) +
                       str(sys.exc_info()) )
            return
    except:
        print(&#34;Cannot start HTML Win %s&#34; % str(newfname), sys.exc_info())
        pedync.message(&#34;\n   Cannot start %s \n\n&#34;  % str(newfname) +
                   str(sys.exc_info()) )
        return</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_m4filter"><code class="name flex">
<span>def <span class="ident">start_m4filter</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_m4filter(self):

    #print(&#34;Filter called.&#34;)
    self.save()
    comline = [&#34;m4&#34;, self.fname,]
    try:
        ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
    except:
        print(&#34;Cannot filter %s&#34; % str(comline), sys.exc_info())
        pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                   str(sys.exc_info()) )
        return
    try:
        outs, errs = ret.communicate()
    except:
        print(&#34;Cannot communicate with filter %s&#34; % str(comline), sys.exc_info())
        return

    res = outs.decode(&#34;cp437&#34;)
    #print(&#34;res&#34;, res)

    www = self.mained.get_width()
    if self.mained.hpaned3.get_position() &gt; www - 20:
        self.mained.hpaned3.set_position(www - www / 4)
        self.mained.update_statusbar(&#34;Filter output active&#34;)

    newfname = os.path.splitext(self.fname)[0] + &#34;.html&#34;

    pppp = self.notebook3.get_nth_page(0)
    self.notebook3.set_tab_label(pppp,
                self.mained.make_label(&#34;Filter on M4 &#39;&#34; +
                         os.path.basename(newfname) + &#34;&#39;&#34;))
    arrx = res.split(&#34;\n&#34;)
    self.mained.diffpane.area.loadbuff(arrx)
    self.mained.diffpane.area.fname = newfname
    self.mained.update_statusbar(&#34;M4 filter output activated.&#34;)
    self.start_htmlwin(res)</code></pre>
</details>
</dd>
<dt id="pedtask.pedtask.start_mdfilter"><code class="name flex">
<span>def <span class="ident">start_mdfilter</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def start_mdfilter(self):

    #print(&#34;MD Filter called.&#34;, os.getcwd())

    yfname = os.path.dirname(__file__) + os.sep + &#34;default.yml&#34;

    print(yfname)

    #comline = [&#34;md2html&#34;, &#34;-s&#34;, yfname, self.fname,]

    comline = [&#34;markdown&#34;, self.fname,]

    outs = &#39;&#39;
    try:
        ret = subprocess.Popen(comline, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
    except:
        print(&#34;Cannot start MD filter %s&#34; % str(comline), sys.exc_info())
        pedync.message(&#34;\n   Cannot filter %s \n\n&#34;  % str(comline) +
                   str(sys.exc_info()) )
        return
    try:
        outs, errs = ret.communicate()
    except:
        print(&#34;Cannot communicate with MD filter %s&#34; % str(comline), sys.exc_info())
        return

    newfname = os.path.splitext(self.fname)[0] + &#34;.preview.html&#34;
    #print(&#34;processed:&#34;, self.fname, newfname)
    with open(newfname,&#39;wb&#39;) as fd:
        fd.write(outs)

    if not os.path.isfile(newfname):
        print(&#34;No conversion on %s&#34; % self.fname)
        pedync.message(&#34;\n   Cannot convert &#39;%s&#39; \n&#34;
            &#34;   to MD / HTML file\n\n&#34;  % self.fname )
        return

    self.start_htmlwin(newfname)
    pedconfig.conf.pedwin.cleanit.append(newfname)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pedtask.pedtask" href="#pedtask.pedtask">pedtask</a></code></h4>
<ul class="two-column">
<li><code><a title="pedtask.pedtask.start_browser" href="#pedtask.pedtask.start_browser">start_browser</a></code></li>
<li><code><a title="pedtask.pedtask.start_edit" href="#pedtask.pedtask.start_edit">start_edit</a></code></li>
<li><code><a title="pedtask.pedtask.start_external" href="#pedtask.pedtask.start_external">start_external</a></code></li>
<li><code><a title="pedtask.pedtask.start_htmlstr" href="#pedtask.pedtask.start_htmlstr">start_htmlstr</a></code></li>
<li><code><a title="pedtask.pedtask.start_htmlwin" href="#pedtask.pedtask.start_htmlwin">start_htmlwin</a></code></li>
<li><code><a title="pedtask.pedtask.start_m4filter" href="#pedtask.pedtask.start_m4filter">start_m4filter</a></code></li>
<li><code><a title="pedtask.pedtask.start_mdfilter" href="#pedtask.pedtask.start_mdfilter">start_mdfilter</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>